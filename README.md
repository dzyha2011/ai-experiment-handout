# 卷积神经网络实验

本文件夹包含完整的卷积神经网络实验代码和讲义。

## 文件说明

- `卷积神经网络实验讲义-1e5b4927c6.md` - 完整的实验讲义，包含理论知识和代码示例
- `cnn_mnist_complete_example.py` - 完整可运行的CNN实验代码
- `requirements.txt` - 所需Python库列表
- `README.md` - 本说明文件

## 快速开始

### 1. 安装依赖

```bash
pip install -r requirements.txt
```

### 2. 运行实验

```bash
python cnn_mnist_complete_example.py
```

### 3. 预期结果

- 程序会自动下载MNIST数据集（首次运行）
- 训练两种CNN模型：SimpleCNN和DeepCNN
- 使用tqdm进度条实时显示训练进度，包括损失值和准确率
- 显示训练过程和最终准确率
- 生成训练曲线和混淆矩阵图表
- 保存训练好的模型权重

## 实验内容

### 理论部分
- 卷积神经网络基本原理
- CNN核心组件详解
- 数据预处理流程
- 模型训练与评估

### 实践部分
- MNIST手写数字识别
- 猫狗图像分类（迁移学习）
- 训练进度可视化（tqdm进度条）
- 代码填空练习及答案
- 完整可运行示例

### 代码填空答案

**填空1**: 数据预处理
- ①处: `X.reshape(-1, 1, 28, 28) / 255.0`
- ②处: `10000`

**填空2**: 深层CNN模型
- ①处: `32` (输入通道数)
- ②处: `64` (输出通道数)
- ③处: `64 * 3 * 3` (特征数量)
- ④处: `64 * 3 * 3` (展平操作)

**填空3**: 学习率调度器
- ①处: `StepLR`
- ②处: `3`
- ③处: `0.1`
- ④处: `scheduler.step()`

## 系统要求

- Python 3.7+
- 推荐使用GPU（CUDA支持）进行训练
- 至少4GB内存
- 约1GB磁盘空间（用于数据集和模型）

## 新增功能

### 训练进度可视化
- 使用tqdm库显示训练和验证进度条
- 实时显示当前批次的损失值和准确率
- 显示当前学习率（训练阶段）
- 提供更好的用户体验和训练监控

## 故障排除

### 常见问题

1. **训练进度条卡住不动**
   - Windows系统：将DataLoader的num_workers设为0
   - 检查GPU内存是否充足，可尝试减少batch_size
   - 确保数据集路径正确且可访问

2. **MNIST数据集下载失败**
   - 检查网络连接
   - 可能需要科学上网
   - 可手动下载数据集

3. **CUDA相关错误**
   - 确保安装了正确版本的PyTorch
   - 检查CUDA版本兼容性
   - 可使用CPU版本：`device = torch.device("cpu")`

4. **内存不足**
   - 减小batch_size
   - 使用更小的模型
   - 关闭其他程序释放内存

5. **混合精度训练报错**
    - 某些GPU不支持，可禁用混合精度训练

6. **TypeError: unsupported format string passed to tuple.__format__**
    - 原因：`evaluate_model`函数返回三个值，但调用时只接收一个变量
    - 解决：正确接收所有返回值：`test_acc, y_pred, y_true = evaluate_model(model, test_loader)`

7. **验证阶段进度条卡顿**
    - 原因：使用`len([x for x in val_pbar])`导致性能问题
    - 解决：使用`enumerate(val_pbar)`获取batch索引，避免低效的列表推导式操作

### 性能优化

- 使用GPU训练可显著提升速度
- 调整batch_size以充分利用GPU内存
- 使用混合精度训练节省显存

## 扩展实验

1. **超参数调优**
   - 尝试不同的学习率
   - 调整网络结构
   - 使用不同的优化器

2. **数据增强**
   - 添加更多数据变换
   - 使用AutoAugment
   - 实现Mixup技术

3. **高级技术**
   - 实现残差连接
   - 使用注意力机制
   - 尝试知识蒸馏

## 联系方式

如有问题或建议，请联系实验指导老师。